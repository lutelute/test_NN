<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grokking Visualization - Technical Note</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/5.2.0/github-markdown.min.css">
    <style>
        body {
            background-color: #0d1117;
            color: #c9d1d9;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
        }
        .container {
            max-width: 980px;
            margin: 0 auto;
            padding: 45px;
        }
        .markdown-body {
            background-color: #0d1117;
            color: #c9d1d9;
        }
        .markdown-body h1, .markdown-body h2, .markdown-body h3 {
            border-bottom-color: #21262d;
            color: #f0f6fc;
        }
        .markdown-body code {
            background-color: #161b22;
            color: #c9d1d9;
        }
        .markdown-body pre {
            background-color: #161b22;
            border: 1px solid #30363d;
        }
        .markdown-body table {
            border-collapse: collapse;
        }
        .markdown-body table th, .markdown-body table td {
            border: 1px solid #30363d;
            padding: 8px 12px;
        }
        .markdown-body table tr {
            background-color: #0d1117;
        }
        .markdown-body table tr:nth-child(2n) {
            background-color: #161b22;
        }
        .markdown-body blockquote {
            border-left-color: #3b5998;
            color: #8b949e;
        }
        .markdown-body a {
            color: #58a6ff;
        }
        .markdown-body hr {
            background-color: #21262d;
        }
        .header {
            text-align: center;
            padding: 40px 0;
            border-bottom: 1px solid #21262d;
            margin-bottom: 40px;
        }
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        .header p {
            color: #8b949e;
            font-size: 1.2em;
        }
        .animation-demo {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            padding: 30px;
            margin: 30px 0;
            text-align: center;
        }
        .animation-demo h3 {
            color: white;
            margin-top: 0;
        }
        .circle-animation {
            width: 200px;
            height: 200px;
            margin: 20px auto;
            position: relative;
        }
        .dot {
            width: 8px;
            height: 8px;
            background: white;
            border-radius: 50%;
            position: absolute;
            animation: orbit 4s linear infinite;
        }
        @keyframes orbit {
            from { transform: rotate(0deg) translateX(80px) rotate(0deg); }
            to { transform: rotate(360deg) translateX(80px) rotate(-360deg); }
        }
        .dot:nth-child(1) { animation-delay: 0s; }
        .dot:nth-child(2) { animation-delay: 0.2s; }
        .dot:nth-child(3) { animation-delay: 0.4s; }
        .dot:nth-child(4) { animation-delay: 0.6s; }
        .dot:nth-child(5) { animation-delay: 0.8s; }
        .dot:nth-child(6) { animation-delay: 1.0s; }
        .dot:nth-child(7) { animation-delay: 1.2s; }
        .dot:nth-child(8) { animation-delay: 1.4s; }
        .toc {
            background-color: #161b22;
            border: 1px solid #30363d;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .toc h3 {
            margin-top: 0;
            color: #f0f6fc;
        }
        .toc ul {
            list-style: none;
            padding-left: 0;
        }
        .toc li {
            padding: 5px 0;
        }
        .toc a {
            color: #58a6ff;
            text-decoration: none;
        }
        .toc a:hover {
            text-decoration: underline;
        }
        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            margin-right: 8px;
        }
        .badge-python { background-color: #3776ab; color: white; }
        .badge-pytorch { background-color: #ee4c2c; color: white; }
        .badge-streamlit { background-color: #ff4b4b; color: white; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Grokking Visualization</h1>
            <p>ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ã€Œçªç„¶ã®ç†è§£ã€ã‚’å¯è¦–åŒ–ã™ã‚‹</p>
            <div>
                <span class="badge badge-python">Python</span>
                <span class="badge badge-pytorch">PyTorch</span>
                <span class="badge badge-streamlit">Streamlit</span>
            </div>
        </div>

        <div class="animation-demo">
            <h3>Fourier Representation - å††ç’°æ§‹é€ </h3>
            <div class="circle-animation">
                <div class="dot"></div>
                <div class="dot"></div>
                <div class="dot"></div>
                <div class="dot"></div>
                <div class="dot"></div>
                <div class="dot"></div>
                <div class="dot"></div>
                <div class="dot"></div>
            </div>
            <p style="color: rgba(255,255,255,0.8);">Grokkingå¾Œã€ãƒ¢ãƒ‡ãƒ«ã¯æ•°å€¤ã‚’å††ç’°ä¸Šã«é…ç½®ã™ã‚‹ãƒ•ãƒ¼ãƒªã‚¨è¡¨ç¾ã‚’å­¦ç¿’</p>
        </div>

        <div class="toc">
            <h3>ç›®æ¬¡</h3>
            <ul>
                <li><a href="#grokking">Grokkingç¾è±¡ã¨ã¯</a>
                    <ul>
                        <li>é€šå¸¸ã®å­¦ç¿’ã¨ã®é•ã„</li>
                        <li>ãªãœä¸æ€è­°ãªã®ã‹</li>
                    </ul>
                </li>
                <li><a href="#modular">ãƒ¢ã‚¸ãƒ¥ãƒ©ãƒ¼åŠ ç®—ã‚¿ã‚¹ã‚¯</a>
                    <ul>
                        <li>ãƒ¢ã‚¸ãƒ¥ãƒ©ãƒ¼æ¼”ç®—ã¨ã¯ï¼ˆæ™‚è¨ˆã®ä¾‹ï¼‰</li>
                        <li>ãªãœè¶³ã—ç®—ã‚’å­¦ç¿’ã•ã›ã‚‹ã®ã‹</li>
                        <li>ç´ æ•°ã‚’ä½¿ã†ç†ç”±</li>
                    </ul>
                </li>
                <li><a href="#fourier">ãƒ•ãƒ¼ãƒªã‚¨è¡¨ç¾ç†è«–</a></li>
                <li><a href="#visualization">å¯è¦–åŒ–ã®è¦‹æ–¹</a></li>
                <li><a href="#usage">ä½¿ã„æ–¹</a></li>
            </ul>
        </div>

        <article class="markdown-body">
            <h2 id="grokking">Grokkingç¾è±¡ã¨ã¯</h2>

            <p><strong>Grokking</strong>ï¼ˆã‚°ãƒ­ãƒƒã‚­ãƒ³ã‚°ï¼‰ã¯ã€SFä½œå®¶ãƒ­ãƒãƒ¼ãƒˆãƒ»Aãƒ»ãƒã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã®å°èª¬ã€ç•°æ˜Ÿã®å®¢ã€(1961) ã«ç™»å ´ã™ã‚‹ç«æ˜Ÿèªã§ã€ã€Œæ·±ãç›´æ„Ÿçš„ã«ç†è§£ã™ã‚‹ã€ã¨ã„ã†æ„å‘³ã§ã™ã€‚</p>

            <p>æ©Ÿæ¢°å­¦ç¿’ã§ã¯ã€<strong>éå­¦ç¿’çŠ¶æ…‹ãŒé•·æœŸé–“ç¶šã„ãŸå¾Œã€çªç„¶æ±åŒ–ãŒèµ·ã“ã‚‹ç¾è±¡</strong>ã‚’æŒ‡ã—ã¾ã™ã€‚</p>

            <h3>é€šå¸¸ã®å­¦ç¿’ vs Grokking</h3>

            <table>
                <tr>
                    <th>ãƒ•ã‚§ãƒ¼ã‚º</th>
                    <th>é€šå¸¸ã®å­¦ç¿’</th>
                    <th>Grokking</th>
                </tr>
                <tr>
                    <td>åˆæœŸ</td>
                    <td>Train/Testå…±ã«ä¸Šæ˜‡</td>
                    <td>Trainã®ã¿ä¸Šæ˜‡</td>
                </tr>
                <tr>
                    <td>ä¸­æœŸ</td>
                    <td>ä¸¡æ–¹ãŒåæŸ</td>
                    <td>Train 100%, Test ~0%</td>
                </tr>
                <tr>
                    <td>å¾ŒæœŸ</td>
                    <td>ï¼ˆçµ‚äº†ï¼‰</td>
                    <td>çªç„¶ Test ãŒæ€¥ä¸Šæ˜‡!</td>
                </tr>
            </table>

            <h3>ãªãœä¸æ€è­°ãªã®ã‹</h3>
            <ul>
                <li><strong>éå­¦ç¿’ = æ‚ª</strong>ã¨ã„ã†å¸¸è­˜ã«åã™ã‚‹</li>
                <li><strong>æ—©æœŸåœæ­¢</strong>ã—ãŸã‚‰æ±åŒ–ã—ãªã„</li>
                <li>è¨“ç·´100%ã®ãšã£ã¨å¾Œã«ãƒ†ã‚¹ãƒˆç²¾åº¦ãŒä¸ŠãŒã‚‹</li>
            </ul>

            <hr>

            <h2 id="modular">ãƒ¢ã‚¸ãƒ¥ãƒ©ãƒ¼åŠ ç®—ã‚¿ã‚¹ã‚¯</h2>

            <h3>ãƒ¢ã‚¸ãƒ¥ãƒ©ãƒ¼æ¼”ç®—ï¼ˆå‰°ä½™æ¼”ç®—ï¼‰ã¨ã¯</h3>
            <p><strong>ãƒ¢ã‚¸ãƒ¥ãƒ©ãƒ¼æ¼”ç®—</strong>ã¯ã€ã‚ã‚‹æ•°ã§å‰²ã£ãŸã€Œä½™ã‚Šã€ã‚’æ‰±ã†æ¼”ç®—ã§ã™ã€‚æ—¥å¸¸ç”Ÿæ´»ã§ã¯æ™‚è¨ˆãŒæœ€ã‚‚èº«è¿‘ãªä¾‹ã§ã™ã€‚</p>

            <pre><code>é€šå¸¸ã®åŠ ç®—:    5 + 3 = 8
ãƒ¢ã‚¸ãƒ¥ãƒ©ãƒ¼åŠ ç®—: (5 + 3) mod 7 = 1  ï¼ˆ8Ã·7ã®ä½™ã‚Šï¼‰</code></pre>

            <h3>æ™‚è¨ˆã§ç†è§£ã™ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ©ãƒ¼æ¼”ç®—</h3>
            <div style="background: #161b22; padding: 20px; border-radius: 8px; margin: 15px 0;">
                <pre><code>ğŸ•™ ç¾åœ¨ 10æ™‚ã€3æ™‚é–“å¾Œã¯ï¼Ÿ
   (10 + 3) mod 12 = 13 mod 12 = 1æ™‚

ğŸ•™ ç¾åœ¨ 10æ™‚ã€5æ™‚é–“å¾Œã¯ï¼Ÿ
   (10 + 5) mod 12 = 15 mod 12 = 3æ™‚

ğŸ•˜ ç¾åœ¨ 9æ™‚ã€15æ™‚é–“å¾Œã¯ï¼Ÿ
   (9 + 15) mod 12 = 24 mod 12 = 0æ™‚ï¼ˆ= 12æ™‚ï¼‰</code></pre>
            </div>
            <p>12ã‚’è¶…ãˆã‚‹ã¨ã€Œå·»ãæˆ»ã‚‹ã€â€”ã“ã‚ŒãŒãƒ¢ã‚¸ãƒ¥ãƒ©ãƒ¼æ¼”ç®—ã®æœ¬è³ªã§ã™ã€‚</p>

            <h3>ãªãœã€Œè¶³ã—ç®—ã€ã‚’å­¦ç¿’ã•ã›ã‚‹ã®ã‹</h3>
            <table>
                <tr>
                    <th>ç†ç”±</th>
                    <th>èª¬æ˜</th>
                </tr>
                <tr>
                    <td><strong>ã‚·ãƒ³ãƒ—ãƒ«ã ãŒéè‡ªæ˜</strong></td>
                    <td>é€šå¸¸ã®è¶³ã—ç®—ã¯ç·šå½¢ã ãŒã€ãƒ¢ã‚¸ãƒ¥ãƒ©ãƒ¼åŠ ç®—ã¯å‘¨æœŸçš„ã§éç·šå½¢æ€§ãŒå¿…è¦</td>
                </tr>
                <tr>
                    <td><strong>æ•°å­¦çš„ã«è§£æå¯èƒ½</strong></td>
                    <td>ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ã§å³å¯†ã«è§£æã§ãã€ãƒ¢ãƒ‡ãƒ«ãŒã€Œä½•ã‚’å­¦ã‚“ã ã‹ã€ã‚’æ¤œè¨¼ã§ãã‚‹</td>
                </tr>
                <tr>
                    <td><strong>GrokkingãŒè¦³å¯Ÿã—ã‚„ã™ã„</strong></td>
                    <td>å°ã•ãªãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§è¨˜æ†¶ vs æ±åŒ–ã®å¢ƒç•ŒãŒæ˜ç¢º</td>
                </tr>
            </table>

            <h3>æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­å®š</h3>
            <div style="background: #161b22; padding: 20px; border-radius: 8px; margin: 15px 0;">
                <pre><code>å…¥åŠ›: (a, b) where a, b âˆˆ {0, 1, 2, ..., 96}
å‡ºåŠ›: (a + b) mod 97

å…·ä½“ä¾‹:
  (50, 30) â†’ 80       ï¼ˆ50 + 30 = 80 < 97 ãªã®ã§ãã®ã¾ã¾ï¼‰
  (50, 60) â†’ 13       ï¼ˆ50 + 60 = 110ã€110 mod 97 = 13ï¼‰
  (96,  1) â†’ 0        ï¼ˆ96 + 1 = 97ã€97 mod 97 = 0ï¼‰</code></pre>
            </div>

            <ul>
                <li><strong>p = 97</strong>ï¼ˆç´ æ•°ï¼‰â€” å‘¨æœŸæ§‹é€ ãŒå˜ç´”ã«ãªã‚‹</li>
                <li><strong>å…¨ãƒšã‚¢æ•°</strong>: 97 Ã— 97 = 9,409 é€šã‚Š</li>
                <li><strong>è¨“ç·´ãƒ‡ãƒ¼ã‚¿</strong>: 30%ï¼ˆç´„2,800ãƒšã‚¢ï¼‰</li>
                <li><strong>ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿</strong>: 70%ï¼ˆç´„6,600ãƒšã‚¢ï¼‰</li>
            </ul>

            <h3>ãªãœç´ æ•° p = 97 ã‚’ä½¿ã†ã®ã‹</h3>
            <p>ç´ æ•°ã‚’ä½¿ã†ã¨ã€ãƒ¢ã‚¸ãƒ¥ãƒ©ãƒ¼æ¼”ç®—ãŒ<strong>å·¡å›ç¾¤</strong>ã‚’å½¢æˆã—ã€ãƒ•ãƒ¼ãƒªã‚¨è§£æã¨ç›¸æ€§ãŒè‰¯ããªã‚Šã¾ã™ã€‚</p>
            <div style="background: #161b22; padding: 20px; border-radius: 8px; margin: 15px 0;">
                <pre><code>p=5 ã®å ´åˆã®è¶³ã—ç®—ãƒ†ãƒ¼ãƒ–ãƒ«:

    + | 0  1  2  3  4
   ---+---------------
    0 | 0  1  2  3  4
    1 | 1  2  3  4  0  â† 4+1=5ã€5 mod 5 = 0
    2 | 2  3  4  0  1
    3 | 3  4  0  1  2
    4 | 4  0  1  2  3

â†’ å…¨ã¦ã®æ•°ãŒå¾ªç’°çš„ã«ç¾ã‚Œã‚‹ï¼ˆå·¡å›ç¾¤ï¼‰</code></pre>
            </div>

            <hr>

            <h2 id="fourier">ãƒ•ãƒ¼ãƒªã‚¨è¡¨ç¾ç†è«–</h2>

            <p>Grokkingå¾Œã€ãƒ¢ãƒ‡ãƒ«ã¯æ•°å€¤ã‚’<strong>ãƒ•ãƒ¼ãƒªã‚¨åŸºåº•</strong>ã§åŸ‹ã‚è¾¼ã¿ã¾ã™ï¼š</p>

            <pre><code>e(n) â‰ˆ [cos(2Ï€kn/p), sin(2Ï€kn/p)]</code></pre>

            <p>ã“ã®è¡¨ç¾ã§ã¯ã€æ•°å€¤ãŒ<strong>å††å‘¨ä¸Š</strong>ã«ç­‰é–“éš”ã§é…ç½®ã•ã‚Œã¾ã™ã€‚</p>

            <hr>

            <h2 id="visualization">å¯è¦–åŒ–ã®è¦‹æ–¹</h2>

            <h3>1. å††ç’°æ§‹é€ ï¼ˆå·¦ãƒ‘ãƒãƒ«ï¼‰</h3>
            <table>
                <tr>
                    <th>çŠ¶æ…‹</th>
                    <th>è¦‹ãŸç›®</th>
                    <th>Circleå€¤</th>
                </tr>
                <tr>
                    <td>å­¦ç¿’åˆæœŸ</td>
                    <td>ãƒ©ãƒ³ãƒ€ãƒ ãªæ•£ã‚‰ã°ã‚Š</td>
                    <td>&lt; 0.3</td>
                </tr>
                <tr>
                    <td>è¨˜æ†¶æ®µéš</td>
                    <td>ä¸è¦å‰‡ãªã‚¯ãƒ©ã‚¹ã‚¿</td>
                    <td>0.3 - 0.7</td>
                </tr>
                <tr>
                    <td>Grokkingå¾Œ</td>
                    <td>ãã‚Œã„ãªå††ç’°</td>
                    <td>&gt; 0.9</td>
                </tr>
            </table>

            <h3>2. ãƒ‹ãƒ¥ãƒ¼ãƒ­ãƒ³ç›¸é–¢è¡Œåˆ—ï¼ˆ7Ã—7ã‚°ãƒªãƒƒãƒ‰ï¼‰</h3>
            <ul>
                <li><strong>å††å½¢ãƒ‘ã‚¿ãƒ¼ãƒ³</strong>: cos/sinãƒšã‚¢ï¼ˆãƒ•ãƒ¼ãƒªã‚¨åŸºåº•ï¼‰</li>
                <li><strong>ç›´ç·šãƒ‘ã‚¿ãƒ¼ãƒ³</strong>: å¼·ã„ç›¸é–¢</li>
                <li><strong>ãƒ©ãƒ³ãƒ€ãƒ æ•£å¸ƒ</strong>: ç‹¬ç«‹ã—ãŸæ¬¡å…ƒ</li>
            </ul>

            <h3>3. å­¦ç¿’æ›²ç·š</h3>
            <ul>
                <li><strong>é’ç·š</strong>: Train Accuracy</li>
                <li><strong>èµ¤ç·š</strong>: Test Accuracy</li>
                <li><strong>é»„è‰²ç¸¦ç·š</strong>: ç¾åœ¨ã®ã‚¨ãƒãƒƒã‚¯</li>
            </ul>

            <hr>

            <h2 id="usage">ä½¿ã„æ–¹</h2>

            <h3>ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</h3>
            <pre><code>git clone https://github.com/lutelute/test_NN.git
cd test_NN
pip install -r requirements.txt</code></pre>

            <h3>å­¦ç¿’ã®å®Ÿè¡Œ</h3>
            <pre><code># 10ã‚¨ãƒãƒƒã‚¯åˆ»ã¿ã§å­¦ç¿’
python train_grokking_demo.py --linear --save_interval 10

# 2ã‚¨ãƒãƒƒã‚¯åˆ»ã¿ã§è©³ç´°å­¦ç¿’
python train_grokking_demo.py --linear --save_interval 2 --checkpoint_dir checkpoints_demo_2ep</code></pre>

            <h3>å¯è¦–åŒ–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h3>
            <pre><code>streamlit run interactive_dashboard.py</code></pre>

            <p>ãƒ–ãƒ©ã‚¦ã‚¶ã§ <code>http://localhost:8501</code> ã‚’é–‹ã</p>

            <hr>

            <h2>å‚è€ƒæ–‡çŒ®</h2>
            <ol>
                <li>Power, A., et al. (2022). "Grokking: Generalization Beyond Overfitting on Small Algorithmic Datasets"</li>
                <li>Neel Nanda et al. (2023). "Progress measures for grokking via mechanistic interpretability"</li>
            </ol>

            <hr>

            <p style="text-align: center; color: #8b949e;">
                <a href="https://github.com/lutelute/test_NN">GitHub Repository</a> |
                <a href="https://github.com/lutelute/test_NN/blob/main/TECHNICAL_NOTE.md">Full Technical Note</a>
            </p>
        </article>
    </div>
</body>
</html>
